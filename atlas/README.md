# SQLマイグレーション管理

Atlas https://atlasgo.io/docs

## セットアップ

インストール

```bash
curl -sSf https://atlasgo.sh | sh
```

シーケンスとかマテビューのマイグレーションを使うのには、ログインが必要
bonosという組織を作成したので、管理者に招待してもらってからログインをしてください。

```bash
atlas login bonos
```

## テーブルの変更

https://atlasgo.io/declarative/apply
Declative Workflowsという方法で管理を行なっています。

`./schema.hcl`にテーブルの構成がまとまっているので、変更してください。

変更内容の確認を以下のコマンドを行えます。
記述が間違っていればエラーがでます。

```bash
make migrate-diff
> -- Create "users" table
> CREATE TABLE "public"."users" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY, "name" > character varying(255) NOT NULL, PRIMARY KEY ("id"));
```

問題なければDBに変更を反映します。

```bash
make migrate

? Are you sure?: 
  ▸ Apply
    Lint and edit
    Abort

✔ Apply
```
